{"ast":null,"code":"import _objectSpread from\"/Users/ares/DEV/Visibility strategy score/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * Service centralisé pour les appels API\n * Gère automatiquement les URLs relatives ou absolues selon la configuration\n */const API_BASE_URL=process.env.REACT_APP_API_URL||'';/**\n * Construit l'URL complète pour un endpoint API\n * @param {string} endpoint - L'endpoint (ex: '/api/analyze')\n * @returns {string} L'URL complète\n */function getApiUrl(endpoint){// Si API_BASE_URL est défini, l'utiliser\nif(API_BASE_URL){// Enlever le slash final de API_BASE_URL s'il existe\nconst base=API_BASE_URL.endsWith('/')?API_BASE_URL.slice(0,-1):API_BASE_URL;// Enlever le slash initial de endpoint s'il existe\nconst path=endpoint.startsWith('/')?endpoint:\"/\".concat(endpoint);return\"\".concat(base).concat(path);}// Sinon, utiliser l'URL relative (même domaine)\nreturn endpoint;}/**\n * Effectue un appel API avec gestion d'erreurs améliorée\n * @param {string} endpoint - L'endpoint API\n * @param {object} options - Les options fetch\n * @returns {Promise<Response>}\n */async function apiCall(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const url=getApiUrl(endpoint);const defaultOptions={headers:_objectSpread({'Content-Type':'application/json'},options.headers)};const response=await fetch(url,_objectSpread(_objectSpread({},defaultOptions),options));if(!response.ok){// Essayer de parser le JSON, sinon utiliser le texte\nlet errorData;const contentType=response.headers.get('content-type');try{if(contentType&&contentType.includes('application/json')){errorData=await response.json();}else{const text=await response.text();// Si c'est du HTML ou du texte d'erreur, créer un objet d'erreur\nif(text.includes('Proxy')||text.includes('proxy')||text.includes('<html')){throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');}throw new Error(text||\"Erreur HTTP \".concat(response.status));}}catch(parseError){// Si le parsing JSON échoue, utiliser le message d'erreur\nif(parseError.message.includes('Proxy')||parseError.message.includes('proxy')){throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');}throw parseError;}throw new Error(errorData.error||errorData.message||'Erreur lors de l\\'appel API');}// Vérifier que la réponse est bien du JSON\nconst contentType=response.headers.get('content-type');if(!contentType||!contentType.includes('application/json')){const text=await response.text();if(text.includes('Proxy')||text.includes('proxy')||text.includes('<html')){throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');}throw new Error('Réponse invalide du serveur');}return response;}const apiService={getApiUrl,apiCall,// Méthodes utilitaires\nget:function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return apiCall(endpoint,_objectSpread(_objectSpread({},options),{},{method:'GET'}));},post:function(endpoint,data){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return apiCall(endpoint,_objectSpread(_objectSpread({},options),{},{method:'POST',body:JSON.stringify(data)}));},put:function(endpoint,data){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return apiCall(endpoint,_objectSpread(_objectSpread({},options),{},{method:'PUT',body:JSON.stringify(data)}));},delete:function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return apiCall(endpoint,_objectSpread(_objectSpread({},options),{},{method:'DELETE'}));}};export default apiService;","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","getApiUrl","endpoint","base","endsWith","slice","path","startsWith","concat","apiCall","options","arguments","length","undefined","url","defaultOptions","headers","_objectSpread","response","fetch","ok","errorData","contentType","get","includes","json","text","Error","status","parseError","message","error","apiService","method","post","data","body","JSON","stringify","put","delete"],"sources":["/Users/ares/DEV/Visibility strategy score/frontend/src/services/api.js"],"sourcesContent":["/**\n * Service centralisé pour les appels API\n * Gère automatiquement les URLs relatives ou absolues selon la configuration\n */\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '';\n\n/**\n * Construit l'URL complète pour un endpoint API\n * @param {string} endpoint - L'endpoint (ex: '/api/analyze')\n * @returns {string} L'URL complète\n */\nfunction getApiUrl(endpoint) {\n  // Si API_BASE_URL est défini, l'utiliser\n  if (API_BASE_URL) {\n    // Enlever le slash final de API_BASE_URL s'il existe\n    const base = API_BASE_URL.endsWith('/') ? API_BASE_URL.slice(0, -1) : API_BASE_URL;\n    // Enlever le slash initial de endpoint s'il existe\n    const path = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    return `${base}${path}`;\n  }\n  // Sinon, utiliser l'URL relative (même domaine)\n  return endpoint;\n}\n\n/**\n * Effectue un appel API avec gestion d'erreurs améliorée\n * @param {string} endpoint - L'endpoint API\n * @param {object} options - Les options fetch\n * @returns {Promise<Response>}\n */\nasync function apiCall(endpoint, options = {}) {\n  const url = getApiUrl(endpoint);\n  const defaultOptions = {\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n  };\n\n  const response = await fetch(url, { ...defaultOptions, ...options });\n\n  if (!response.ok) {\n    // Essayer de parser le JSON, sinon utiliser le texte\n    let errorData;\n    const contentType = response.headers.get('content-type');\n    try {\n      if (contentType && contentType.includes('application/json')) {\n        errorData = await response.json();\n      } else {\n        const text = await response.text();\n        // Si c'est du HTML ou du texte d'erreur, créer un objet d'erreur\n        if (text.includes('Proxy') || text.includes('proxy') || text.includes('<html')) {\n          throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');\n        }\n        throw new Error(text || `Erreur HTTP ${response.status}`);\n      }\n    } catch (parseError) {\n      // Si le parsing JSON échoue, utiliser le message d'erreur\n      if (parseError.message.includes('Proxy') || parseError.message.includes('proxy')) {\n        throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');\n      }\n      throw parseError;\n    }\n    throw new Error(errorData.error || errorData.message || 'Erreur lors de l\\'appel API');\n  }\n\n  // Vérifier que la réponse est bien du JSON\n  const contentType = response.headers.get('content-type');\n  if (!contentType || !contentType.includes('application/json')) {\n    const text = await response.text();\n    if (text.includes('Proxy') || text.includes('proxy') || text.includes('<html')) {\n      throw new Error('Erreur de connexion au serveur. Vérifiez votre connexion réseau.');\n    }\n    throw new Error('Réponse invalide du serveur');\n  }\n\n  return response;\n}\n\nconst apiService = {\n  getApiUrl,\n  apiCall,\n  // Méthodes utilitaires\n  get: (endpoint, options = {}) => apiCall(endpoint, { ...options, method: 'GET' }),\n  post: (endpoint, data, options = {}) => \n    apiCall(endpoint, { \n      ...options, \n      method: 'POST', \n      body: JSON.stringify(data) \n    }),\n  put: (endpoint, data, options = {}) => \n    apiCall(endpoint, { \n      ...options, \n      method: 'PUT', \n      body: JSON.stringify(data) \n    }),\n  delete: (endpoint, options = {}) => apiCall(endpoint, { ...options, method: 'DELETE' }),\n};\n\nexport default apiService;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}