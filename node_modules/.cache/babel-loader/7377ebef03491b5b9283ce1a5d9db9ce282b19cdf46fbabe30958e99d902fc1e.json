{"ast":null,"code":"var _jsxFileName = \"/Users/ares/DEV/Visibility strategy score/frontend/src/components/CalendlyModal.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport './CalendlyModal.css';\nimport analytics from '../services/analytics';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CALENDLY_URL = 'https://calendly.com/djerbi/audit-gratuite-pour-evaluer-vos-besoins';\n// URL de l'API backend (depuis variable d'environnement ou proxy en dev)\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '';\nfunction CalendlyModal({\n  isOpen,\n  onClose,\n  onEventScheduled,\n  userData\n}) {\n  _s();\n  const [isConfirmed, setIsConfirmed] = useState(false);\n  useEffect(() => {\n    if (isOpen) {\n      // Charger le script Calendly si pas déjà chargé\n      if (!window.Calendly) {\n        const script = document.createElement('script');\n        script.src = 'https://assets.calendly.com/assets/external/widget.js';\n        script.async = true;\n        document.body.appendChild(script);\n      }\n\n      // Attendre que Calendly soit chargé puis initialiser le widget\n      const initCalendly = () => {\n        if (window.Calendly) {\n          window.Calendly.initInlineWidget({\n            url: CALENDLY_URL,\n            parentElement: document.querySelector('.calendly-inline-widget')\n          });\n        } else {\n          setTimeout(initCalendly, 100);\n        }\n      };\n      setTimeout(initCalendly, 500);\n\n      // Écouter les événements Calendly\n      window.addEventListener('message', handleCalendlyEvent);\n    }\n    return () => {\n      window.removeEventListener('message', handleCalendlyEvent);\n    };\n  }, [isOpen]);\n  const handleCalendlyEvent = e => {\n    if (e.data.event && e.data.event.indexOf('calendly') === 0) {\n      if (e.data.event === 'calendly.event_scheduled') {\n        setIsConfirmed(true);\n        // Envoyer les données à l'API après un court délai pour laisser Calendly terminer\n        setTimeout(async () => {\n          if (onEventScheduled && userData) {\n            try {\n              await fetch('/api/confirm-appointment', {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  email: userData.email,\n                  url: userData.url,\n                  sector: userData.sector,\n                  offer: userData.offer,\n                  analysis_type: userData.analysis_type,\n                  results: userData.results\n                })\n              });\n              onEventScheduled(userData);\n            } catch (error) {\n              console.error('Erreur lors de l\\'envoi de la confirmation:', error);\n            }\n          }\n        }, 2000);\n      }\n    }\n  };\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"calendly-modal-overlay\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"calendly-modal-content\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"calendly-modal-close\",\n        onClick: onClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), !isConfirmed ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendly-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"calendly-modal-title\",\n            children: \"R\\xE9servez votre audit gratuit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"calendly-modal-subtitle\",\n            children: \"Choisissez un cr\\xE9neau qui vous convient pour discuter de vos r\\xE9sultats\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"calendly-inline-widget\",\n          \"data-url\": CALENDLY_URL,\n          style: {\n            minWidth: '320px',\n            height: '700px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"calendly-confirmation\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"confirmation-icon\",\n          children: \"\\u2705\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"confirmation-title\",\n          children: \"Rendez-vous confirm\\xE9 !\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"confirmation-message\",\n          children: \"Merci ! Votre rendez-vous a \\xE9t\\xE9 enregistr\\xE9. Vous allez recevoir un email de confirmation de Calendly.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"confirmation-message\",\n          children: \"Nous vous enverrons \\xE9galement un r\\xE9capitulatif de votre analyse par email.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"confirmation-button\",\n          onClick: onClose,\n          children: \"Fermer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n_s(CalendlyModal, \"N3VFPuRcJ40PRFFbWK80CzhoWOg=\");\n_c = CalendlyModal;\nexport default CalendlyModal;\nvar _c;\n$RefreshReg$(_c, \"CalendlyModal\");","map":{"version":3,"names":["React","useEffect","useState","analytics","jsxDEV","_jsxDEV","Fragment","_Fragment","CALENDLY_URL","API_BASE_URL","process","env","REACT_APP_API_URL","CalendlyModal","isOpen","onClose","onEventScheduled","userData","_s","isConfirmed","setIsConfirmed","window","Calendly","script","document","createElement","src","async","body","appendChild","initCalendly","initInlineWidget","url","parentElement","querySelector","setTimeout","addEventListener","handleCalendlyEvent","removeEventListener","e","data","event","indexOf","fetch","method","headers","JSON","stringify","email","sector","offer","analysis_type","results","error","console","className","onClick","children","stopPropagation","fileName","_jsxFileName","lineNumber","columnNumber","style","minWidth","height","_c","$RefreshReg$"],"sources":["/Users/ares/DEV/Visibility strategy score/frontend/src/components/CalendlyModal.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './CalendlyModal.css';\nimport analytics from '../services/analytics';\n\nconst CALENDLY_URL = 'https://calendly.com/djerbi/audit-gratuite-pour-evaluer-vos-besoins';\n// URL de l'API backend (depuis variable d'environnement ou proxy en dev)\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '';\n\nfunction CalendlyModal({ isOpen, onClose, onEventScheduled, userData }) {\n  const [isConfirmed, setIsConfirmed] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      // Charger le script Calendly si pas déjà chargé\n      if (!window.Calendly) {\n        const script = document.createElement('script');\n        script.src = 'https://assets.calendly.com/assets/external/widget.js';\n        script.async = true;\n        document.body.appendChild(script);\n      }\n\n      // Attendre que Calendly soit chargé puis initialiser le widget\n      const initCalendly = () => {\n        if (window.Calendly) {\n          window.Calendly.initInlineWidget({\n            url: CALENDLY_URL,\n            parentElement: document.querySelector('.calendly-inline-widget'),\n          });\n        } else {\n          setTimeout(initCalendly, 100);\n        }\n      };\n\n      setTimeout(initCalendly, 500);\n\n      // Écouter les événements Calendly\n      window.addEventListener('message', handleCalendlyEvent);\n    }\n\n    return () => {\n      window.removeEventListener('message', handleCalendlyEvent);\n    };\n  }, [isOpen]);\n\n  const handleCalendlyEvent = (e) => {\n    if (e.data.event && e.data.event.indexOf('calendly') === 0) {\n      if (e.data.event === 'calendly.event_scheduled') {\n        setIsConfirmed(true);\n        // Envoyer les données à l'API après un court délai pour laisser Calendly terminer\n        setTimeout(async () => {\n          if (onEventScheduled && userData) {\n            try {\n              await fetch('/api/confirm-appointment', {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                  email: userData.email,\n                  url: userData.url,\n                  sector: userData.sector,\n                  offer: userData.offer,\n                  analysis_type: userData.analysis_type,\n                  results: userData.results\n                }),\n              });\n              onEventScheduled(userData);\n            } catch (error) {\n              console.error('Erreur lors de l\\'envoi de la confirmation:', error);\n            }\n          }\n        }, 2000);\n      }\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"calendly-modal-overlay\" onClick={onClose}>\n      <div className=\"calendly-modal-content\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"calendly-modal-close\" onClick={onClose}>\n          ×\n        </button>\n        \n        {!isConfirmed ? (\n          <>\n            <div className=\"calendly-modal-header\">\n              <h2 className=\"calendly-modal-title\">Réservez votre audit gratuit</h2>\n              <p className=\"calendly-modal-subtitle\">\n                Choisissez un créneau qui vous convient pour discuter de vos résultats\n              </p>\n            </div>\n            <div \n              className=\"calendly-inline-widget\" \n              data-url={CALENDLY_URL}\n              style={{ minWidth: '320px', height: '700px' }}\n            />\n          </>\n        ) : (\n          <div className=\"calendly-confirmation\">\n            <div className=\"confirmation-icon\">✅</div>\n            <h2 className=\"confirmation-title\">Rendez-vous confirmé !</h2>\n            <p className=\"confirmation-message\">\n              Merci ! Votre rendez-vous a été enregistré. Vous allez recevoir un email de confirmation de Calendly.\n            </p>\n            <p className=\"confirmation-message\">\n              Nous vous enverrons également un récapitulatif de votre analyse par email.\n            </p>\n            <button className=\"confirmation-button\" onClick={onClose}>\n              Fermer\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default CalendlyModal;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}