{"ast":null,"code":"import React,{useEffect,useState,useCallback}from'react';import'./CalendlyModal.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CALENDLY_URL='https://calendly.com/djerbi/audit-gratuite-pour-evaluer-vos-besoins';function CalendlyModal(_ref){let{isOpen,onClose,onEventScheduled,userData}=_ref;const[isConfirmed,setIsConfirmed]=useState(false);const handleCalendlyEvent=useCallback(e=>{if(e.data.event&&e.data.event.indexOf('calendly')===0){if(e.data.event==='calendly.event_scheduled'){setIsConfirmed(true);// Envoyer les données à l'API après un court délai pour laisser Calendly terminer\nsetTimeout(async()=>{if(onEventScheduled&&userData){try{await fetch('/api/confirm-appointment',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:userData.email,url:userData.url,sector:userData.sector,offer:userData.offer,analysis_type:userData.analysis_type,results:userData.results})});onEventScheduled(userData);}catch(error){console.error('Erreur lors de l\\'envoi de la confirmation:',error);}}},2000);}}},[onEventScheduled,userData]);useEffect(()=>{if(isOpen){// Charger le script Calendly si pas déjà chargé\nif(!window.Calendly){const script=document.createElement('script');script.src='https://assets.calendly.com/assets/external/widget.js';script.async=true;document.body.appendChild(script);}// Attendre que Calendly soit chargé puis initialiser le widget\nconst initCalendly=()=>{if(window.Calendly){window.Calendly.initInlineWidget({url:CALENDLY_URL,parentElement:document.querySelector('.calendly-inline-widget')});}else{setTimeout(initCalendly,100);}};setTimeout(initCalendly,500);// Écouter les événements Calendly\nwindow.addEventListener('message',handleCalendlyEvent);}return()=>{window.removeEventListener('message',handleCalendlyEvent);};},[isOpen,handleCalendlyEvent]);if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"calendly-modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"calendly-modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"calendly-modal-close\",onClick:onClose,children:\"\\xD7\"}),!isConfirmed?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calendly-modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"calendly-modal-title\",children:\"R\\xE9servez votre audit gratuit\"}),/*#__PURE__*/_jsx(\"p\",{className:\"calendly-modal-subtitle\",children:\"Choisissez un cr\\xE9neau qui vous convient pour discuter de vos r\\xE9sultats\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"calendly-inline-widget\",\"data-url\":CALENDLY_URL,style:{minWidth:'320px',height:'700px'}})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"calendly-confirmation\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"confirmation-icon\",children:\"\\u2705\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"confirmation-title\",children:\"Rendez-vous confirm\\xE9 !\"}),/*#__PURE__*/_jsx(\"p\",{className:\"confirmation-message\",children:\"Merci ! Votre rendez-vous a \\xE9t\\xE9 enregistr\\xE9. Vous allez recevoir un email de confirmation de Calendly.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"confirmation-message\",children:\"Nous vous enverrons \\xE9galement un r\\xE9capitulatif de votre analyse par email.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"confirmation-button\",onClick:onClose,children:\"Fermer\"})]})]})});}export default CalendlyModal;","map":{"version":3,"names":["React","useEffect","useState","useCallback","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CALENDLY_URL","CalendlyModal","_ref","isOpen","onClose","onEventScheduled","userData","isConfirmed","setIsConfirmed","handleCalendlyEvent","e","data","event","indexOf","setTimeout","fetch","method","headers","body","JSON","stringify","email","url","sector","offer","analysis_type","results","error","console","window","Calendly","script","document","createElement","src","async","appendChild","initCalendly","initInlineWidget","parentElement","querySelector","addEventListener","removeEventListener","className","onClick","children","stopPropagation","style","minWidth","height"],"sources":["/Users/ares/DEV/Visibility strategy score/frontend/src/components/CalendlyModal.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport './CalendlyModal.css';\n\nconst CALENDLY_URL = 'https://calendly.com/djerbi/audit-gratuite-pour-evaluer-vos-besoins';\n\nfunction CalendlyModal({ isOpen, onClose, onEventScheduled, userData }) {\n  const [isConfirmed, setIsConfirmed] = useState(false);\n\n  const handleCalendlyEvent = useCallback((e) => {\n    if (e.data.event && e.data.event.indexOf('calendly') === 0) {\n      if (e.data.event === 'calendly.event_scheduled') {\n        setIsConfirmed(true);\n        // Envoyer les données à l'API après un court délai pour laisser Calendly terminer\n        setTimeout(async () => {\n          if (onEventScheduled && userData) {\n            try {\n              await fetch('/api/confirm-appointment', {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                  email: userData.email,\n                  url: userData.url,\n                  sector: userData.sector,\n                  offer: userData.offer,\n                  analysis_type: userData.analysis_type,\n                  results: userData.results\n                }),\n              });\n              onEventScheduled(userData);\n            } catch (error) {\n              console.error('Erreur lors de l\\'envoi de la confirmation:', error);\n            }\n          }\n        }, 2000);\n      }\n    }\n  }, [onEventScheduled, userData]);\n\n  useEffect(() => {\n    if (isOpen) {\n      // Charger le script Calendly si pas déjà chargé\n      if (!window.Calendly) {\n        const script = document.createElement('script');\n        script.src = 'https://assets.calendly.com/assets/external/widget.js';\n        script.async = true;\n        document.body.appendChild(script);\n      }\n\n      // Attendre que Calendly soit chargé puis initialiser le widget\n      const initCalendly = () => {\n        if (window.Calendly) {\n          window.Calendly.initInlineWidget({\n            url: CALENDLY_URL,\n            parentElement: document.querySelector('.calendly-inline-widget'),\n          });\n        } else {\n          setTimeout(initCalendly, 100);\n        }\n      };\n\n      setTimeout(initCalendly, 500);\n\n      // Écouter les événements Calendly\n      window.addEventListener('message', handleCalendlyEvent);\n    }\n\n    return () => {\n      window.removeEventListener('message', handleCalendlyEvent);\n    };\n  }, [isOpen, handleCalendlyEvent]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"calendly-modal-overlay\" onClick={onClose}>\n      <div className=\"calendly-modal-content\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"calendly-modal-close\" onClick={onClose}>\n          ×\n        </button>\n        \n        {!isConfirmed ? (\n          <>\n            <div className=\"calendly-modal-header\">\n              <h2 className=\"calendly-modal-title\">Réservez votre audit gratuit</h2>\n              <p className=\"calendly-modal-subtitle\">\n                Choisissez un créneau qui vous convient pour discuter de vos résultats\n              </p>\n            </div>\n            <div \n              className=\"calendly-inline-widget\" \n              data-url={CALENDLY_URL}\n              style={{ minWidth: '320px', height: '700px' }}\n            />\n          </>\n        ) : (\n          <div className=\"calendly-confirmation\">\n            <div className=\"confirmation-icon\">✅</div>\n            <h2 className=\"confirmation-title\">Rendez-vous confirmé !</h2>\n            <p className=\"confirmation-message\">\n              Merci ! Votre rendez-vous a été enregistré. Vous allez recevoir un email de confirmation de Calendly.\n            </p>\n            <p className=\"confirmation-message\">\n              Nous vous enverrons également un récapitulatif de votre analyse par email.\n            </p>\n            <button className=\"confirmation-button\" onClick={onClose}>\n              Fermer\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default CalendlyModal;\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CAC/D,MAAO,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE7B,KAAM,CAAAC,YAAY,CAAG,qEAAqE,CAE1F,QAAS,CAAAC,aAAaA,CAAAC,IAAA,CAAkD,IAAjD,CAAEC,MAAM,CAAEC,OAAO,CAAEC,gBAAgB,CAAEC,QAAS,CAAC,CAAAJ,IAAA,CACpE,KAAM,CAACK,WAAW,CAAEC,cAAc,CAAC,CAAGhB,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAAiB,mBAAmB,CAAGhB,WAAW,CAAEiB,CAAC,EAAK,CAC7C,GAAIA,CAAC,CAACC,IAAI,CAACC,KAAK,EAAIF,CAAC,CAACC,IAAI,CAACC,KAAK,CAACC,OAAO,CAAC,UAAU,CAAC,GAAK,CAAC,CAAE,CAC1D,GAAIH,CAAC,CAACC,IAAI,CAACC,KAAK,GAAK,0BAA0B,CAAE,CAC/CJ,cAAc,CAAC,IAAI,CAAC,CACpB;AACAM,UAAU,CAAC,SAAY,CACrB,GAAIT,gBAAgB,EAAIC,QAAQ,CAAE,CAChC,GAAI,CACF,KAAM,CAAAS,KAAK,CAAC,0BAA0B,CAAE,CACtCC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,KAAK,CAAEf,QAAQ,CAACe,KAAK,CACrBC,GAAG,CAAEhB,QAAQ,CAACgB,GAAG,CACjBC,MAAM,CAAEjB,QAAQ,CAACiB,MAAM,CACvBC,KAAK,CAAElB,QAAQ,CAACkB,KAAK,CACrBC,aAAa,CAAEnB,QAAQ,CAACmB,aAAa,CACrCC,OAAO,CAAEpB,QAAQ,CAACoB,OACpB,CAAC,CACH,CAAC,CAAC,CACFrB,gBAAgB,CAACC,QAAQ,CAAC,CAC5B,CAAE,MAAOqB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,6CAA6C,CAAEA,KAAK,CAAC,CACrE,CACF,CACF,CAAC,CAAE,IAAI,CAAC,CACV,CACF,CACF,CAAC,CAAE,CAACtB,gBAAgB,CAAEC,QAAQ,CAAC,CAAC,CAEhCf,SAAS,CAAC,IAAM,CACd,GAAIY,MAAM,CAAE,CACV;AACA,GAAI,CAAC0B,MAAM,CAACC,QAAQ,CAAE,CACpB,KAAM,CAAAC,MAAM,CAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAC/CF,MAAM,CAACG,GAAG,CAAG,uDAAuD,CACpEH,MAAM,CAACI,KAAK,CAAG,IAAI,CACnBH,QAAQ,CAACd,IAAI,CAACkB,WAAW,CAACL,MAAM,CAAC,CACnC,CAEA;AACA,KAAM,CAAAM,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAIR,MAAM,CAACC,QAAQ,CAAE,CACnBD,MAAM,CAACC,QAAQ,CAACQ,gBAAgB,CAAC,CAC/BhB,GAAG,CAAEtB,YAAY,CACjBuC,aAAa,CAAEP,QAAQ,CAACQ,aAAa,CAAC,yBAAyB,CACjE,CAAC,CAAC,CACJ,CAAC,IAAM,CACL1B,UAAU,CAACuB,YAAY,CAAE,GAAG,CAAC,CAC/B,CACF,CAAC,CAEDvB,UAAU,CAACuB,YAAY,CAAE,GAAG,CAAC,CAE7B;AACAR,MAAM,CAACY,gBAAgB,CAAC,SAAS,CAAEhC,mBAAmB,CAAC,CACzD,CAEA,MAAO,IAAM,CACXoB,MAAM,CAACa,mBAAmB,CAAC,SAAS,CAAEjC,mBAAmB,CAAC,CAC5D,CAAC,CACH,CAAC,CAAE,CAACN,MAAM,CAAEM,mBAAmB,CAAC,CAAC,CAEjC,GAAI,CAACN,MAAM,CAAE,MAAO,KAAI,CAExB,mBACER,IAAA,QAAKgD,SAAS,CAAC,wBAAwB,CAACC,OAAO,CAAExC,OAAQ,CAAAyC,QAAA,cACvDhD,KAAA,QAAK8C,SAAS,CAAC,wBAAwB,CAACC,OAAO,CAAGlC,CAAC,EAAKA,CAAC,CAACoC,eAAe,CAAC,CAAE,CAAAD,QAAA,eAC1ElD,IAAA,WAAQgD,SAAS,CAAC,sBAAsB,CAACC,OAAO,CAAExC,OAAQ,CAAAyC,QAAA,CAAC,MAE3D,CAAQ,CAAC,CAER,CAACtC,WAAW,cACXV,KAAA,CAAAE,SAAA,EAAA8C,QAAA,eACEhD,KAAA,QAAK8C,SAAS,CAAC,uBAAuB,CAAAE,QAAA,eACpClD,IAAA,OAAIgD,SAAS,CAAC,sBAAsB,CAAAE,QAAA,CAAC,iCAA4B,CAAI,CAAC,cACtElD,IAAA,MAAGgD,SAAS,CAAC,yBAAyB,CAAAE,QAAA,CAAC,8EAEvC,CAAG,CAAC,EACD,CAAC,cACNlD,IAAA,QACEgD,SAAS,CAAC,wBAAwB,CAClC,WAAU3C,YAAa,CACvB+C,KAAK,CAAE,CAAEC,QAAQ,CAAE,OAAO,CAAEC,MAAM,CAAE,OAAQ,CAAE,CAC/C,CAAC,EACF,CAAC,cAEHpD,KAAA,QAAK8C,SAAS,CAAC,uBAAuB,CAAAE,QAAA,eACpClD,IAAA,QAAKgD,SAAS,CAAC,mBAAmB,CAAAE,QAAA,CAAC,QAAC,CAAK,CAAC,cAC1ClD,IAAA,OAAIgD,SAAS,CAAC,oBAAoB,CAAAE,QAAA,CAAC,2BAAsB,CAAI,CAAC,cAC9DlD,IAAA,MAAGgD,SAAS,CAAC,sBAAsB,CAAAE,QAAA,CAAC,gHAEpC,CAAG,CAAC,cACJlD,IAAA,MAAGgD,SAAS,CAAC,sBAAsB,CAAAE,QAAA,CAAC,kFAEpC,CAAG,CAAC,cACJlD,IAAA,WAAQgD,SAAS,CAAC,qBAAqB,CAACC,OAAO,CAAExC,OAAQ,CAAAyC,QAAA,CAAC,QAE1D,CAAQ,CAAC,EACN,CACN,EACE,CAAC,CACH,CAAC,CAEV,CAEA,cAAe,CAAA5C,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}